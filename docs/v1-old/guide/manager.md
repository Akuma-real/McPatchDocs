---
title: 创建更新包
---
## 准备要更新的文件

第一步，首先需要决定好哪些文件要更新，哪些不需要。然后把需要更新的文件，复制到`workspace`目录里去，注意复制时需要保持与在客户端相同的文件结构。

下面一些栗子可以参考：（不存在的文件夹需要手动创建）

+ 要更新所有模组，复制 `.minecraft/mods` 目录
  + 到 `mp/workspace/.minecraft/mods`

+ 要更新资源包，复制 `.minecraft/resourcepacks` 目录
  + 到 `mp/workspace/.minecraft/resourcepacks`

+ 要更新.minecraft目录旁边的 `新玩家进服教程.txt`，复制 `新玩家进服教程.txt` 文件
  + 到 `mp/workspace/新玩家进服教程.txt`

+ 如果你开了版本隔离，就需要复制 `.minecraft/versions/your-version/mods` 目录
  + 到 `mp/workspace/.minecraft/versions/your-version/mods`
  + 其它文件也是同理，需要复制到versions目录下

到这里你可能已经看出规律了：`workspace` 目录相当于本地的 `.minecraft` 的父目录。只有 `workspace` 目录和客户端保持相同文件结构，文件才能更新到正确的地方

:::tip
若开启了版本隔离，那么要更新的实际上是 versions 目录下的 mods 文件夹，具体可以看上面的最后一条例子。（客户端程序本身严格按照管理端摆放的文件结构更新，不会读取任何MC或者启动器的配置信息）
:::

:::warning

不要一股脑把整个 `.minecraft` 目录全部丢进更新，Minecraft 的核心文件和 Minecraft 的资源文件大部分情况下是不能加入更新的，尤其是打算配置一键启动时，会导致更新失败！

:::

## 创建首个更新包

接下来可以开始创建更新包了，首先双击刚创建的 `manage.bat` 脚本即可启动管理端。管理端使用交互式命令行来完成各种操作，即使是在黑框命令行下也非常简单易用

看到主界面以后，我们输入 `c` 或 `1`，按下回车键就可以开始创建第一个更新包。第一个版本号通常输入 1.0，当然你也可以输入任何你喜欢的版本号风格，好了之后按 Enter 确定

:::warning

版本号只能包括大小写字母数字，以及 `!@#$()_+-=;',.` 切勿使用中文，空格，或其它字符

:::

输入版本号之后，程序会列出你对文件的所有更改。因为我们是第一次打更新包，文件很多，我们粗略看一下就好，后续打包建议还是稍微看一下这个列表，确保对文件的修改都是没问题的

如果给这个版本写更新记录，可以在此时打开 `changelogs.txt` 文件，把你的更新记录粘贴进去并保存（更新记录只能使用 UTF8 编码的纯文本，不支持富文本格式）。如果你不想写更新记录，请直接跳过这一步

接着输入 `y` 开始正式打包，首次打包内容一般都较大，可能会花费相当多的时间，请耐心等待

等到出现 `创建版本完成` 的字样后，就说明打包成功了（更新包文件会保存在public目录下）

:::danger

请勿替换更新包中的任何文件，包中存储的是 bzip 压缩数据，并非原样存储，胡乱修改会导致客户端报错和后续更新全部失败！（如果你一定要修改包中文件，请在修改完后，使用管理端 t 命令来验证压缩包完整性）

:::

:::danger

已经发布的更新包不支持撤回，更不能手动删除文件，这会导致后面更新的文件数据错乱，且不会触发任何的报错弹框。此时应该再打一个新的版本来修复上个版本里的问题

若实在需要撤回这个版本，请参考[版本发错了怎么办](./caution.md#版本发错了怎么办)

:::

## 后续发布新版

后续发布新版本很简单，只需要对 `workspace` 目录下的文件做修改（就像对本地文件一样修改就好），然后打一个更新包就完成了，管理端会自动检测新旧文件差异生成更新包。

比如我想要删除客户端的一个模组 a.jar 再添加一个新的模组 b.jar，那么只需要在工作空间目录下删掉 a.jar 然后复制进去 b.jar，接着打包新版本就好

若新旧文件同名，但文件内容被修改了也只一样的做法：直接覆盖旧文件就好，程序也能自动检测到

对目录的新建和删除也是一样，该怎么新建怎么新建，该什么删除怎么删除，就就像对本地文件一样进行这些操作

如果你在工作空间目录改了一些文件，但又觉得不妥，想要还原工作空间到没修改之前，可以启动管理端，输入 `4` 或 `restore` 来还原

## 目录用途说明

1. worksapce 工作空间目录：服主日常维护客户端文件内容的地方
2. history历史目录：用来作为对比，以计算你对 workspace 目录做了哪些修改的目录
   + 此目录由程序自动维护，切勿手动修改，会导致数据错乱，若不小心修改了，参考[注意事项](./caution.md#不小心修改了history目录)来还原
3. public公共目录：用来存放历史更新包，
   + 版本列表文件（versions.txt）—— 这个文件仅 1.1 版本的管理端才有
   + 更新包文件（.zip）—— 这个文件仅 1.1 版本的管理端才有